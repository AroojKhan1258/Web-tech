<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CRUD Dashboard</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>
  body { background:#000; color:#fff; font-family:"Poppins",sans-serif; }
  .card-bg { background:#111; border:none; border-radius:12px; padding:20px; margin-bottom:30px; }
  .form-control, .form-select { background:#222; color:#fff; border:1px solid #333; }
  .form-control:focus, .form-select:focus { box-shadow:0 0 0 0.2rem rgba(255,77,77,0.15); border-color:#ff4d4d; }
  .list-group-item { background:#222; border:none; display:flex; justify-content:space-between; align-items:center; padding:12px 15px; border-radius:8px; margin-bottom:10px; }
  .btn { background:#ff4d4d; color:#fff; transition:0.3s; }
  .btn:hover { background:#e63c3c; }
  .loading { text-align:center; font-size:18px; margin:20px 0; }
  .text-error { color:#ff4d4d; margin-top:10px; }
</style>
</head>
<body>

<main class="container py-5">

  <h2 class="mb-4">CRUD Dashboard</h2>

  <!-- Add/Update Form -->
  <div class="card card-bg p-4 mb-4">
    <h5>Add / Update Item</h5>
    <form id="crudForm">
      <div class="row g-3">
        <div class="col-md-4">
          <input type="text" id="itemName" class="form-control" placeholder="Item Name" required>
        </div>
        <div class="col-md-4">
          <input type="number" id="itemPrice" class="form-control" placeholder="Price" required>
        </div>
        <div class="col-md-4">
          <button class="btn w-100" id="addItem">Add Item</button>
        </div>
      </div>
    </form>
    <div id="formError" class="text-error"></div>
  </div>

  <!-- Items List -->
  <div class="card card-bg p-4">
    <h5>Items List</h5>
    <div id="loading" class="loading">Loading items...</div>
    <ul id="itemList" class="list-unstyled"></ul>
    <div id="listError" class="text-error"></div>
  </div>

</main>

<script>
$(document).ready(function(){

  const apiURL = "https://fakestoreapi.com/products";
  let items = [];
  let editingId = null;

  function renderList(){
    $("#itemList").empty();
    if(items.length===0){ $("#itemList").append("<li>No items available.</li>"); return; }
    items.forEach(item=>{
      $("#itemList").append(`
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <strong>${item.title}</strong> - â‚¨ ${item.price}
          </div>
          <div>
            <button class="btn btn-sm btn-warning edit" data-id="${item.id}">Edit</button>
            <button class="btn btn-sm btn-danger remove" data-id="${item.id}">Delete</button>
          </div>
        </li>
      `);
    });
  }

  // Load items from API
  function loadItems(){
    $("#loading").show();
    $("#listError").text("");
    $.ajax({
      url: apiURL,
      method: "GET",
      success: function(data){
        items = data.map(i=>({id:i.id, title:i.title, price:i.price}));
        $("#loading").hide();
        renderList();
      },
      error: function(){
        $("#loading").hide();
        $("#listError").text("Failed to load items. Try again.");
      }
    });
  }

  loadItems();

  // Add/Update item
  $("#addItem").click(function(e){
    e.preventDefault();
    const title = $("#itemName").val().trim();
    const price = parseFloat($("#itemPrice").val());
    if(!title || price<=0){ $("#formError").text("Enter valid name and price."); return; }
    $("#formError").text("");

    const payload = { title, price, description:"Demo item", image:"https://i.pravatar.cc", category:"general" };

    if(editingId){
      // Update item
      $.ajax({
        url: `${apiURL}/${editingId}`,
        method:"PUT",
        data: JSON.stringify(payload),
        contentType:"application/json",
        success: function(data){
          loadItems();
          editingId = null;
          $("#crudForm")[0].reset();
        },
        error: function(){ $("#formError").text("Update failed."); }
      });
    } else {
      // Create new item
      $.ajax({
        url: apiURL,
        method:"POST",
        data: JSON.stringify(payload),
        contentType:"application/json",
        success: function(data){
          loadItems();
          $("#crudForm")[0].reset();
        },
        error: function(){ $("#formError").text("Add failed."); }
      });
    }
  });

  // Delete item
  $(document).on("click",".remove", function(){
    const id = $(this).data("id");
    $.ajax({
      url: `${apiURL}/${id}`,
      method:"DELETE",
      success: function(){ loadItems(); },
      error: function(){ $("#listError").text("Delete failed."); }
    });
  });

  // Edit item
  $(document).on("click",".edit", function(){
    const id = $(this).data("id");
    const item = items.find(i=>i.id===id);
    if(item){
      $("#itemName").val(item.title);
      $("#itemPrice").val(item.price);
      editingId = id;
    }
  });

});
</script>

</body>
</html>
